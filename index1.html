<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOL Monitor Pro - Dados Reais</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a202c, #2d3748);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.5rem;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .data-row:last-child {
            border-bottom: none;
        }
        .label {
            color: #94a3b8;
        }
        .value {
            font-weight: 600;
            font-family: monospace;
        }
        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
        }
        .status-success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        .status-error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä SOL Monitor Pro</h1>
            <p>Dados reais da CoinGecko API | Atualiza√ß√£o a cada 30 segundos</p>
        </div>

        <div class="card">
            <h2>Pre√ßo Atual</h2>
            <div class="loading" id="priceLoading">
                <div class="spinner"></div>
                Carregando dados...
            </div>
            <div id="priceData" style="display: none;">
                <div class="data-row">
                    <span class="label">SOL/USDT:</span>
                    <span class="value" id="currentPrice">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">24h High:</span>
                    <span class="value" id="high24h">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">24h Low:</span>
                    <span class="value" id="low24h">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">Volume 24h:</span>
                    <span class="value" id="volume24h">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">Market Cap:</span>
                    <span class="value" id="marketCap">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">Varia√ß√£o 24h:</span>
                    <span class="value" id="priceChange">0.00%</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Indicadores T√©cnicos (15m)</h2>
            <div class="loading" id="indicatorsLoading">
                <div class="spinner"></div>
                Calculando indicadores...
            </div>
            <div id="indicatorsData" style="display: none;">
                <div class="data-row">
                    <span class="label">MACD:</span>
                    <span class="value" id="macdValue">0.0000</span>
                </div>
                <div class="data-row">
                    <span class="label">Signal:</span>
                    <span class="value" id="macdSignal">0.0000</span>
                </div>
                <div class="data-row">
                    <span class="label">EMA 6:</span>
                    <span class="value" id="ema6Value">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">EMA 25:</span>
                    <span class="value" id="ema25Value">$0.00</span>
                </div>
                <div class="data-row">
                    <span class="label">Bollinger Width:</span>
                    <span class="value" id="bbWidth">0.00%</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Status</h2>
            <div class="data-row">
                <span class="label">API Status:</span>
                <span class="status status-success" id="apiStatus">Conectado</span>
            </div>
            <div class="data-row">
                <span class="label">√öltima Atualiza√ß√£o:</span>
                <span class="value" id="lastUpdate">-</span>
            </div>
        </div>
    </div>

    <script>
        // Fun√ß√£o para formatar n√∫meros grandes
        function formatNumber(num) {
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return num.toFixed(2);
        }

        // Fun√ß√£o principal para buscar dados
        async function fetchData() {
            try {
                // Usando um proxy CORS para contornar o bloqueio
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const coinUrl = `${proxyUrl}https://api.coingecko.com/api/v3/coins/solana`;
                const chartUrl = `${proxyUrl}https://api.coingecko.com/api/v3/coins/solana/market_chart?vs_currency=usd&days=1&interval=5min`;

                // Buscar dados principais
                const coinRes = await fetch(coinUrl);
                if (!coinRes.ok) throw new Error(`Erro na API: ${coinRes.status}`);
                const coinData = await coinRes.json();

                // Buscar dados hist√≥ricos
                const chartRes = await fetch(chartUrl);
                if (!chartRes.ok) throw new Error(`Erro na API: ${chartRes.status}`);
                const chartData = await chartRes.json();

                // Extrair dados
                const price = coinData.market_data.current_price.usd;
                const change = coinData.market_data.price_change_percentage_24h;
                const high24h = coinData.market_data.high_24h.usd;
                const low24h = coinData.market_data.low_24h.usd;
                const volume24h = coinData.market_data.total_volume.usd;
                const marketCap = coinData.market_data.market_cap.usd;

                // Calcular indicadores t√©cnicos simples com os dados hist√≥ricos
                const prices = chartData.prices.map(p => p[1]);
                const lastPrice = prices[prices.length - 1];
                const prevPrice = prices[prices.length - 2] || lastPrice;
                const macdValue = (lastPrice - prevPrice) * 0.5; // Simplifica√ß√£o para demonstra√ß√£o
                const ema6 = prices.slice(-6).reduce((a, b) => a + b, 0) / 6;
                const ema25 = prices.slice(-25).reduce((a, b) => a + b, 0) / 25;
                const bbUpper = ema6 + (prices.slice(-20).reduce((a, b) => a + Math.pow(b - ema6, 2), 0) / 20) ** 0.5 * 2;
                const bbLower = ema6 - (prices.slice(-20).reduce((a, b) => a + Math.pow(b - ema6, 2), 0) / 20) ** 0.5 * 2;
                const bbWidth = ((bbUpper - bbLower) / ema6) * 100;

                // Atualizar UI
                document.getElementById('currentPrice').textContent = `$${price.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                document.getElementById('priceChange').textContent = `${change > 0 ? '+' : ''}${change.toFixed(2)}%`;
                document.getElementById('high24h').textContent = `$${high24h.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                document.getElementById('low24h').textContent = `$${low24h.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                document.getElementById('volume24h').textContent = `$${formatNumber(volume24h)}`;
                document.getElementById('marketCap').textContent = `$${formatNumber(marketCap)}`;
                document.getElementById('macdValue').textContent = macdValue.toFixed(4);
                document.getElementById('macdSignal').textContent = (macdValue * 0.8).toFixed(4);
                document.getElementById('ema6Value').textContent = `$${ema6.toFixed(2)}`;
                document.getElementById('ema25Value').textContent = `$${ema25.toFixed(2)}`;
                document.getElementById('bbWidth').textContent = `${bbWidth.toFixed(2)}%`;

                // Esconder loading, mostrar dados
                document.getElementById('priceLoading').style.display = 'none';
                document.getElementById('priceData').style.display = 'block';
                document.getElementById('indicatorsLoading').style.display = 'none';
                document.getElementById('indicatorsData').style.display = 'block';
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('pt-BR');

                // Atualizar status
                document.getElementById('apiStatus').className = 'status status-success';
                document.getElementById('apiStatus').textContent = 'Conectado';

            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                document.getElementById('apiStatus').className = 'status status-error';
                document.getElementById('apiStatus').textContent = 'Erro';
                document.getElementById('priceLoading').textContent = 'Erro ao carregar dados. Tente novamente.';
                document.getElementById('indicatorsLoading').textContent = 'Erro ao calcular indicadores.';
            }
        }

        // Iniciar
        document.addEventListener('DOMContentLoaded', () => {
            fetchData(); // Carregar dados imediatamente
            setInterval(fetchData, 30000); // Atualizar a cada 30 segundos
        });
    </script>
</body>
</html>
